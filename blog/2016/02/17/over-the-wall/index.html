
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>OVER THE WALL - LinJunzhu&#8217;s Blog</title>
	<meta name="author" content="林俊柱">

	
	<meta name="description" content="OVER THE WALL 1
2
3
4
5
小时候，自由是一张破旧的五角钱，我在这头，美食在外头。 长大了，自由是一纸灼人的高考卷，我在这头，大学在外头。 后来啊，自由是一道宏伟的柏林墙，我在这头，世界在外头。 &ldquo;子轩，把那个什么门发我下。&rdquo; 犹记得第一次接触「wall &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="LinJunzhu's Blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">LinJunzhu&#8217;s Blog</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:github.com/linjunzhu/linjunzhu.github.io.git">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="https://www.google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:github.com/linjunzhu/linjunzhu.github.io.git">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">OVER the WALL</h2>
	<div class="entry-content"><h1>OVER THE WALL</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>小时候，自由是一张破旧的五角钱，我在这头，美食在外头。
</span><span class='line'>
</span><span class='line'>长大了，自由是一纸灼人的高考卷，我在这头，大学在外头。
</span><span class='line'>
</span><span class='line'>后来啊，自由是一道宏伟的柏林墙，我在这头，世界在外头。</span></code></pre></td></tr></table></div></figure>


<p>&ldquo;子轩，把那个什么门发我下。&rdquo;</p>

<p>犹记得第一次接触「wall」的概念，还是大学第二学期，在听子轩介绍完 &ldquo;自由门&rdquo; 的神奇之后，就立马让他发给了我，从此打开了 &ldquo;新世界&rdquo; 的大门~</p>

<h2>工具</h2>

<p>现在的翻墙方式挺多的，主流的有：</p>

<ol>
<li>VPN</li>
<li>代理</li>
<li>ShadowSocks</li>
</ol>


<h2>VPN</h2>

<p>VPN 相当于虚拟出一个虚拟网卡，流量全部走这个虚拟网卡，而如果做了智能分流(修改路由表)的话，访问国内网站会走真实网卡，其他的走虚拟网卡。</p>

<p>VPN 推荐：<a href="http://igotvpn.com/?r=cc22a7c3d700276e">云梯</a></p>

<h2>代理</h2>

<p>顾名思义，将要访问的网站将会通过「代理服务器」来进行中转，操作简单，只需设置下代理地址即可。</p>

<p>代理 推荐：<a href="http://theqingyun.info/r/dkp2pm">轻云</a></p>

<h2>ShadowSocks</h2>

<p>SS 则是通过 SOCKS5 代理的方式，如果你是用 Mac 的话，点开 Wifi 设置 => 高级，就会看到代理的选项。</p>

<p>能否代理要看使用的软件支不支持 SOCKS5 代理,有些软件只支持 HTTP 代理，那就没辙了</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Chrome : 点开设置你会发现它是默认是用系统代理设置的
</span><span class='line'>QQ : 不使用系统代理设置，可以自定义代理设置
</span><span class='line'>邮件: 默认系统代理设置</span></code></pre></td></tr></table></div></figure>


<p>SS 推荐: <a href="crola.xyz">crola.xyz</a> ( 现在注册需要邀请码，有需要可以找我拿 )</p>

<h2>SHELL 无法代理？</h2>

<p>由于 VPN 是全局流量，因此 SHELL 的流量也是走 VPN 的，因此也处于「翻墙状态」</p>

<p>但 代理 &amp; ShadowSocks 的方式不一样，需要程序支持</p>

<p>而SHELL 只支持 HTTP 代理，并且需要如下设置:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># .zshrc / .bashrc 等配置文件之一</span>
</span><span class='line'><span class="n">export</span> <span class="n">http_proxy</span><span class="o">=</span><span class="ss">proxy_addr</span><span class="p">:</span><span class="n">port</span>
</span></code></pre></td></tr></table></div></figure>


<p>如此 SHELL 也处于了「翻墙」的状态了。</p>

<p>但是 ShadowSocks 是通过 SOCKS5 的方式，并不支持 HTTP 流量，因此我们需要工具来将流量转换成 SOCKS5 并且转发给 SS 代理服务。</p>

<p>常见的工具有 ProxyChains-NG、polipo</p>

<h2>ProxyChains-NG</h2>

<p>项目主页： <a href="https://github.com/rofl0r/proxychains-ng">https://github.com/rofl0r/proxychains-ng</a></p>

<h3>安装</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">brew</span> <span class="n">install</span> <span class="n">proxychains</span><span class="o">-</span><span class="n">ng</span>
</span></code></pre></td></tr></table></div></figure>


<h3>配置</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="n">vim</span> <span class="sr">/usr/</span><span class="n">local</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">proxychains</span><span class="o">.</span><span class="n">conf</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># edit</span>
</span><span class='line'><span class="n">strict_chain</span>
</span><span class='line'><span class="n">proxy_dns</span>
</span><span class='line'><span class="n">remote_dns_subnet</span> <span class="mi">224</span>
</span><span class='line'><span class="n">tcp_read_time_out</span> <span class="mi">15000</span>
</span><span class='line'><span class="n">tcp_connect_time_out</span> <span class="mi">8000</span>
</span><span class='line'><span class="n">localnet</span> <span class="mi">127</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="mi">255</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="n">quiet_mode</span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span><span class="no">ProxyList</span><span class="o">]</span>
</span><span class='line'><span class="n">socks5</span>  <span class="mi">127</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span> <span class="mi">1080</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># 本地开启的服务正是 1080 端口</span>
</span></code></pre></td></tr></table></div></figure>


<h3>使用</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">proxychains4</span> <span class="o">-</span><span class="n">q</span> <span class="n">curl</span> <span class="s1">&#39;google.com&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">## 添加 alias(在 .zshrc / .bashrc ....)</span>
</span><span class='line'><span class="k">alias</span> <span class="n">ss</span><span class="o">=</span><span class="s2">&quot;proxychains4 -q&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">## 简化</span>
</span><span class='line'><span class="n">ss</span> <span class="n">curl</span> <span class="s1">&#39;google.com&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>过程</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">SHELL</span> <span class="err">发出</span> <span class="n">request</span> <span class="o">=&gt;</span> <span class="no">ProxyChains</span><span class="o">-</span><span class="no">NG</span> <span class="err">将</span> <span class="no">HTTP</span> <span class="err">流量转换成</span> <span class="no">SOCKS5</span> <span class="err">流量</span> <span class="o">=&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="err">本地</span> <span class="no">SS</span> <span class="err">服务</span> <span class="err">转发请求到</span> <span class="err">远程</span> <span class="no">SS</span> <span class="err">服务器</span> <span class="o">=&gt;</span> <span class="no">SS</span> <span class="err">服务器请求实际</span> <span class="n">request</span><span class="p">,</span> <span class="err">将</span> <span class="n">response</span> <span class="err">返回</span>
</span></code></pre></td></tr></table></div></figure>


<h3>10.11</h3>

<p>由于 Mac OSX 10.11 增加了安全机制，导致无法使用，唯一方法就是关闭 SIP</p>

<ol>
<li>首先重启系统，在开机时按住 Command+R 来进入 Recovery 模式</li>
<li>菜单栏中找到 terminal, 打开</li>
<li>执行: csrutil disable</li>
<li>如果想恢复，可以执行: csrutil enable</li>
</ol>


<h2>polipo</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">brew</span> <span class="n">install</span> <span class="n">polipo</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">vim</span> <span class="sr">/usr/</span><span class="n">local</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">polipo</span><span class="o">/</span><span class="n">homebrew</span><span class="o">.</span><span class="n">mxcl</span><span class="o">.</span><span class="n">polipo</span><span class="o">.</span><span class="n">plist</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="p">?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="sc">?&gt;</span>
</span><span class='line'><span class="o">&lt;!</span><span class="no">DOCTYPE</span> <span class="n">plist</span> <span class="no">PUBLIC</span> <span class="s2">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span> <span class="s2">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="n">plist</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="o">&lt;</span><span class="n">dict</span><span class="o">&gt;</span>
</span><span class='line'>     <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span><span class="no">Label</span><span class="o">&lt;</span><span class="sr">/key&gt;</span>
</span><span class='line'><span class="sr">     &lt;string&gt;homebrew.mxcl.polipo&lt;/s</span><span class="n">tring</span><span class="o">&gt;</span>
</span><span class='line'>     <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span><span class="no">RunAtLoad</span><span class="o">&lt;</span><span class="sr">/key&gt;</span>
</span><span class='line'><span class="sr">     &lt;true/</span><span class="o">&gt;</span>
</span><span class='line'>     <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span><span class="no">KeepAlive</span><span class="o">&lt;</span><span class="sr">/key&gt;</span>
</span><span class='line'><span class="sr">     &lt;true/</span><span class="o">&gt;</span>
</span><span class='line'>     <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span><span class="no">ProgramArguments</span><span class="o">&lt;</span><span class="sr">/key&gt;</span>
</span><span class='line'><span class="sr">     &lt;array&gt;</span>
</span><span class='line'><span class="sr">       &lt;string&gt;/us</span><span class="n">r</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">polipo</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">polipo</span><span class="o">&lt;</span><span class="sr">/string&gt;</span>
</span><span class='line'><span class="sr">       &lt;string&gt;socksParentProxy=localhost:1080&lt;/s</span><span class="n">tring</span><span class="o">&gt;</span>
</span><span class='line'>     <span class="o">&lt;</span><span class="sr">/array&gt;</span>
</span><span class='line'><span class="sr">     &lt;!-- Set `ulimit -n 65536`. The default macOS limit is 256, that&#39;s</span>
</span><span class='line'><span class="sr">          not enough for Polipo (displays &#39;too many files open&#39; errors).</span>
</span><span class='line'><span class="sr">          It seems like you have no reason to lower this limit</span>
</span><span class='line'><span class="sr">          (and unlikely will want to raise it). --&gt;</span>
</span><span class='line'><span class="sr">     &lt;key&gt;SoftResourceLimits&lt;/</span><span class="n">key</span><span class="o">&gt;</span>
</span><span class='line'>     <span class="o">&lt;</span><span class="n">dict</span><span class="o">&gt;</span>
</span><span class='line'>       <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span><span class="no">NumberOfFiles</span><span class="o">&lt;</span><span class="sr">/key&gt;</span>
</span><span class='line'><span class="sr">       &lt;integer&gt;65536&lt;/in</span><span class="n">teger</span><span class="o">&gt;</span>
</span><span class='line'>     <span class="o">&lt;</span><span class="sr">/dict&gt;</span>
</span><span class='line'><span class="sr">   &lt;/</span><span class="n">dict</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">&lt;</span><span class="sr">/plist&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>开机自启动</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">ln</span> <span class="o">-</span><span class="n">sfv</span> <span class="sr">/usr/</span><span class="n">local</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">polipo</span><span class="o">/*.</span><span class="n">plist</span> <span class="o">~</span><span class="sr">/Library/</span><span class="no">LaunchAgents</span>
</span><span class='line'><span class="n">launchctl</span> <span class="nb">load</span> <span class="o">~</span><span class="sr">/Library/</span><span class="no">LaunchAgents</span><span class="o">/</span><span class="n">homebrew</span><span class="o">.</span><span class="n">mxcl</span><span class="o">.</span><span class="n">polipo</span><span class="o">.</span><span class="n">plist</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">vim</span> <span class="o">~</span><span class="sr">/.zshrc</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">alias</span> <span class="n">proxy</span><span class="o">=</span><span class="s2">&quot;export http_proxy=http://localhost:8123;export https_proxy=http://localhost:8123&quot;</span>  <span class="c1"># 开启</span>
</span><span class='line'><span class="k">alias</span> <span class="n">unproxy</span><span class="o">=</span><span class="s2">&quot;unset http_proxy&quot;</span>  <span class="c1"># 关闭</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># 开始使用代理</span>
</span><span class='line'><span class="err">$</span> <span class="n">proxy</span>
</span><span class='line'><span class="err">$</span> <span class="n">todo</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1"># 取消使用代理</span>
</span><span class='line'><span class="err">$</span> <span class="n">unproxy</span>
</span><span class='line'><span class="err">$</span> <span class="n">todo</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Ping 命令</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># 有人会发现 ping 无法翻墙</span>
</span><span class='line'><span class="n">ss</span> <span class="n">ping</span> <span class="n">google</span><span class="o">.</span><span class="n">com</span>
</span></code></pre></td></tr></table></div></figure>


<p>因为 Ping 命令是使用 ICMP 协议，而 ProxyChains 只支持 TCP and DNS, So ~~</p>

<p><a href="http://proxychains.sourceforge.net/"> http://proxychains.sourceforge.net/ </a></p>
</div>


<div class="meta">
	<div class="date">








  


<time datetime="2016-02-17T15:31:30+08:00" pubdate data-updated="true"></time></div>
	<div class="tags">

</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		
		<a class="addthis_button_tweet"></a>
		
		
		
	</div>
	
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2018

    林俊柱

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>